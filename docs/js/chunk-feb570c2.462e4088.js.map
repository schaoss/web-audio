{"version":3,"sources":["webpack:///./src/views/PannerNode.vue?8b9b","webpack:///./src/lib/audioUnlock.js","webpack:///./src/views/PannerNode.vue?13b1","webpack:///src/views/PannerNode.vue","webpack:///./src/views/PannerNode.vue?614d","webpack:///./src/views/PannerNode.vue"],"names":["audioCtx","state","window","unlock","resume","then","document","body","removeEventListener","addEventListener","render","_vm","this","_h","$createElement","_c","_self","attrs","_v","on","clickHandler","reset","staticClass","_m","_s","frequency","directives","name","rawName","value","expression","domProps","changeHandler","$event","target","volume","_g","dragEvent","style","left","dragData","listener","x","top","y","source","staticRenderFns","data","isPlaying","oscillator","gainNode","panner","waveType","detune","draggingElem","methods","stop","play","setNoteConfig","innerWidth","innerHeight","connect","destination","disconnect","type","gain","setPosition","computed","mousedown","mousemove","e","preventDefault","mouseup","touchstart","touchmove","touchend","mounted","rolloffFactor","start","beforeDestroy","component"],"mappings":"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","file":"js/chunk-feb570c2.462e4088.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PannerNode.vue?vue&type=style&index=0&id=56de157e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PannerNode.vue?vue&type=style&index=0&id=56de157e&lang=scss&scoped=true&\"","export default function(audioCtx) {\n  if (audioCtx.state === 'suspended' && 'ontouchstart' in window) {\n    const unlock = () => {\n      audioCtx.resume().then(() => {\n        document.body.removeEventListener('touchstart', unlock)\n        document.body.removeEventListener('touchend', unlock)\n      })\n    }\n    document.body.addEventListener('touchstart', unlock, false)\n    document.body.addEventListener('touchend', unlock, false)\n  }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"panner-node\"}},[_c('h1',[_vm._v(\"Panner Node\")]),_c('button',{on:{\"click\":_vm.clickHandler}},[_vm._v(\" Play / Pause \")]),_c('button',{on:{\"click\":_vm.reset}},[_vm._v(\" Reset \")]),_c('div',{attrs:{\"id\":\"config\"}},[_c('div',{staticClass:\"audio-note\"},[_vm._m(0),_c('div',{staticClass:\"item\"},[_c('label',{attrs:{\"for\":\"frequency\"}},[_vm._v(\"frequency : \"),_c('span',[_vm._v(_vm._s(_vm.frequency))])]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.frequency),expression:\"frequency\"}],attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"1960\",\"step\":\"1\",\"id\":\"frequencyRange\"},domProps:{\"value\":(_vm.frequency)},on:{\"input\":_vm.changeHandler,\"__r\":function($event){_vm.frequency=$event.target.value}}})])]),_c('div',{staticClass:\"audio-note\"},[_vm._m(1),_c('div',{staticClass:\"item\"},[_c('label',{attrs:{\"for\":\"volume\"}},[_vm._v(\"volume : \"),_c('span',[_vm._v(_vm._s(_vm.volume))])]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.volume),expression:\"volume\"}],attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"5\",\"step\":\"0.1\",\"id\":\"volumeRange\"},domProps:{\"value\":(_vm.volume)},on:{\"input\":_vm.changeHandler,\"__r\":function($event){_vm.volume=$event.target.value}}})])])]),_c('div',_vm._g({attrs:{\"id\":\"drag-area\",\"data-role\":\"drag-drop-container\"}},_vm.dragEvent),[_c('div',{style:({left: this.dragData.listener.x + 'px', top: this.dragData.listener.y + 'px'}),attrs:{\"id\":\"listener\"}},[_vm._v(\" 聽者 \")]),_c('div',{style:({left: this.dragData.source.x + 'px', top: this.dragData.source.y + 'px'}),attrs:{\"id\":\"source\"}},[_vm._v(\" 音源 \")])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('h3',[_c('span',[_vm._v(\"音源\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('h3',[_c('span',[_vm._v(\"增益節點\")])])}]\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"panner-node\">\n    <h1>Panner Node</h1>\n    <button @click=\"clickHandler\"> Play / Pause </button>\n    <button @click=\"reset\"> Reset </button>\n    <div id=\"config\">\n      <div class=\"audio-note\">\n        <h3><span>音源</span></h3>\n        <div class=\"item\">\n          <label for=\"frequency\">frequency : <span>{{frequency}}</span> </label>\n          <input type=\"range\" min=\"0\" max=\"1960\" step=\"1\" id=\"frequencyRange\" v-model=\"frequency\" @input=\"changeHandler\">\n        </div>\n      </div>\n      <div class=\"audio-note\">\n        <h3><span>增益節點</span></h3>\n        <div class=\"item\">\n          <label for=\"volume\">volume : <span>{{volume}}</span> </label>\n          <input type=\"range\" min=\"0\" max=\"5\" step=\"0.1\" id=\"volumeRange\" v-model=\"volume\" @input=\"changeHandler\">\n        </div>\n      </div>\n    </div>\n    <div id=\"drag-area\" data-role=\"drag-drop-container\" v-on=\"dragEvent\">\n      <div id=\"listener\" :style=\"{left: this.dragData.listener.x + 'px', top: this.dragData.listener.y + 'px'}\"> 聽者 </div>\n      <div id=\"source\" :style=\"{left: this.dragData.source.x + 'px', top: this.dragData.source.y + 'px'}\"> 音源 </div>\n    </div>\n  </div>\n</template>\n\n<script>\n/* eslint-disable */\nimport audioUnlock from '../lib/audioUnlock'\nexport default {\n  data() {\n    const AudioContext = window.AudioContext || window.webkitAudioContext // 跨瀏覽器\n    const audioCtx = new AudioContext() // 主控台的概念\n    const oscillator = audioCtx.createOscillator() // 振盪器 (音源)\n    const gainNode = audioCtx.createGain() // 增益節點 控制音量的\n    const panner = audioCtx.createPanner() // 3D音源計算\n    const listener = audioCtx.listener // 聽者\n    return{\n      isPlaying: false,\n      audioCtx,\n      oscillator,\n      gainNode,\n      panner,\n      listener,\n      waveType: 'triangle', // sine, square, sawtooth, triangle\n      frequency: 440, // A4\n      detune: 0, // 解諧 可做出和聲\n      volume: 1, // 音量\n\n      draggingElem: '',\n      dragData: {\n        listener: {\n          x: 0,\n          y: 0\n        },\n        source: {\n          x: 0,\n          y: 0\n        }\n      }\n    }\n  },\n  methods: {\n    clickHandler(){\n      if (this.isPlaying) {\n        this.stop()\n      } else {\n        this.play()\n      }\n      this.isPlaying = !this.isPlaying\n    },\n    changeHandler(){\n      this.setNoteConfig()\n    },\n    reset(){\n      this.frequency = 440\n      this.volume = 1\n      this.dragData = {\n        listener: {\n          x: window.innerWidth / 2 + 20,\n          y: window.innerHeight / 2 - 50\n        },\n        source: {\n          x: window.innerWidth / 2 - 20,\n          y: window.innerHeight / 2 + 50\n        }\n      }\n      this.setNoteConfig()\n    },\n    play() {\n      this.panner.connect(this.audioCtx.destination)\n    },\n    stop() {\n      this.panner.disconnect(this.audioCtx.destination)\n    },\n    setNoteConfig() {\n      this.oscillator.type = this.waveType\n      this.oscillator.frequency.value = this.frequency\n      this.oscillator.detune.value = this.detune\n      this.gainNode.gain.value = this.volume\n      this.panner.setPosition(this.dragData.source.x, this.dragData.source.y, 1)\n      this.listener.setPosition(this.dragData.listener.x, this.dragData.listener.y, 0)\n    }\n  },\n  computed: {\n    dragEvent() {\n      return {\n        mousedown: (e) => {\n          const id = e.target.id\n          if(id === 'source' || id === 'listener') this.draggingElem = e.target.id\n        },\n        mousemove: (e) => {\n          if (!this.draggingElem) {\n            return\n          }\n          this.dragData[this.draggingElem].x = e.clientX - 25\n          this.dragData[this.draggingElem].y = e.clientY - 25\n          this.setNoteConfig()\n          e.preventDefault()\n        }, \n        mouseup: () => {\n          this.draggingElem = ''\n        },\n        touchstart: e => {\n          const id = e.target.id\n          if(id === 'source' || id === 'listener') this.draggingElem = e.target.id\n        },\n        touchmove: e => {\n          if (!this.draggingElem) {\n            return\n          }\n          this.dragData[this.draggingElem].x = e.touches[0].pageX - 25\n          this.dragData[this.draggingElem].y = e.touches[0].pageY - 25\n          this.setNoteConfig()\n          e.preventDefault()\n        },\n        touchend: () => {\n          this.draggingElem = ''\n        }\n      }\n    }\n  },\n  mounted() {\n    audioUnlock(this.audioCtx)\n    this.dragData = {\n      listener: {\n        x: window.innerWidth / 2 + 20,\n        y: window.innerHeight / 2 - 50\n      },\n      source: {\n        x: window.innerWidth / 2 - 20,\n        y: window.innerHeight / 2 + 50\n      }\n    }\n    this.setNoteConfig()\n    this.panner.rolloffFactor = 0.1\n    this.oscillator.connect(this.gainNode) // 將音源接到音量節點上\n    this.gainNode.connect(this.panner)\n    this.oscillator.start() // 啟動音源\n  },\n  beforeDestroy() {\n    if(this.isPlaying) this.panner.disconnect(this.audioCtx.destination)\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n#panner-node {\n  max-height: 100vh;\n  > button {\n    margin: 10px;\n  }\n  #config {\n    display: flex;\n    justify-content: center;\n    flex-direction: row;\n    margin: auto;\n    max-width: 50vw;\n    min-width: 300px;\n    > .audio-note {\n      flex: 1;\n      box-sizing: border-box;\n      margin: 15px auto;\n      border: solid 1px #d9d9d9;\n      > h3 {\n        text-align: center;\n        margin: 10px;\n        > span {\n          display: inline-block;\n        }\n      }\n      > .item {\n        display: flex;\n        width: 100%;\n        margin: 5px auto;\n        padding: 10px;\n        > label {\n          display: inline-block;\n          min-width: 50px;\n          text-align: right;\n          > span {\n            font-weight: 600;\n            display: inline-block;\n            text-align: center;\n          }\n        }\n        > input {\n          width: 100%;\n          max-width: 600px;\n          margin: 0 20px;\n        }\n        > select {\n          margin: 0 20px;\n        }\n      }\n    }\n  }\n  #drag-area {\n    width: 50vw;\n    min-width: 300px;\n    height: 400px;\n    border: solid 1px #d9d9d9;\n    margin: auto;\n    overflow: hidden;\n  }\n  #listener {\n    line-height: 50px;\n    font-size: 150%;\n    user-select: none;\n    position: absolute;\n    width: 50px;\n    height: 50px;\n    border-radius: 50%;\n    padding: 10px;\n    background-color: #3692be;\n  }\n  #source {\n    line-height: 50px;\n    font-size: 150%;\n    user-select: none;\n    position: absolute;\n    width: 50px;\n    height: 50px;\n    border-radius: 50%;\n    padding: 10px;\n    background-color: #bf8f36;\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PannerNode.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PannerNode.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PannerNode.vue?vue&type=template&id=56de157e&scoped=true&\"\nimport script from \"./PannerNode.vue?vue&type=script&lang=js&\"\nexport * from \"./PannerNode.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PannerNode.vue?vue&type=style&index=0&id=56de157e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"56de157e\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}
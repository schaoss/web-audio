(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-227b82a9"],{"0c2b":function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{attrs:{id:"voice-changer"}},[e("h1",[t._v("VoiceChanger")]),e("button",{on:{click:t.clickHandler}},[t._v(" On / Off ")]),e("div",{attrs:{id:"config"}},[e("div",{staticClass:"audio-note"},[e("div",{staticClass:"item"},[e("label",{attrs:{for:"pitchRatio"}},[t._v("頻率倍率 : "),e("span",[t._v(t._s(t.pitchRatio))])]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.pitchRatio,expression:"pitchRatio"}],attrs:{type:"range",min:"0.5",max:"2",step:"0.01",id:"pitchRatio"},domProps:{value:t.pitchRatio},on:{__r:function(i){t.pitchRatio=i.target.value}}})]),e("div",{staticClass:"item"},[e("label",{attrs:{for:"overlapRatio"}},[t._v("重疊率 : "),e("span",[t._v(t._s(t.overlapRatio))])]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.overlapRatio,expression:"overlapRatio"}],attrs:{type:"range",min:"0.1",max:"1",step:"0.01",id:"overlapRatio"},domProps:{value:t.overlapRatio},on:{__r:function(i){t.overlapRatio=i.target.value}}})]),e("div",{staticClass:"result"},t._l(512,function(i){return e("div",{key:i,staticClass:"timeData",style:{height:200*t.timeArray[i-1]+2+"px"}})}))])])])},o=[],n=(e("63d9"),{name:"VoiceChanger",data:function(){var t=window.AudioContext||window.webkitAudioContext,i=new t,e=i.createGain();return e.gain.value=1,{isPlaying:!1,source:null,audioCtx:i,gainNode:e,micStream:null,timeArray:new Float32Array(1024),pitchRatio:1,overlapRatio:.5,bufferSize:2048}},methods:{clickHandler:function(){this.isPlaying?this.stop():this.play()},play:function(){this.isPlaying=!0,this.gainNode.connect(this.audioCtx.destination)},stop:function(){this.isPlaying=!1,this.gainNode.disconnect(this.audioCtx.destination)},getUserMic:function(t){var i=this;this.micStream=t,this.source=this.audioCtx.createMediaStreamSource(t);var e=this.audioCtx.createScriptProcessor(this.bufferSize,1,1),a=new Float32Array(2*this.bufferSize),o=this.hannWindow(this.bufferSize);e.onaudioprocess=function(t){for(var e=t.inputBuffer.getChannelData(0),n=t.outputBuffer.getChannelData(0),r=0;r<e.length;r++)e[r]*=o[r],a[r]=a[r+i.bufferSize],a[r+i.bufferSize]=0;for(var s=new Float32Array(i.bufferSize),c=0,u=0;c<i.bufferSize;c++,u+=parseFloat(i.pitchRatio)){var l=Math.floor(u)%i.bufferSize,f=e[l],d=e[(l+1)%i.bufferSize];s[c]+=i.linearInterpolation(f,d,u%1)*o[c]}for(var h=0;h<i.bufferSize;h+=Math.round(i.bufferSize*i.overlapRatio))for(var v=0;v<=i.bufferSize;v++)a[h+v]+=s[v];for(var p=0;p<i.bufferSize;p++)n[p]=a[p];i.timeArray=n},this.source.connect(e),e.connect(this.gainNode)},hannWindow:function(t){for(var i=new Float32Array(t),e=0;e<t;e++)i[e]=.5*(1-Math.cos(2*Math.PI*e/(t-1)));return i},linearInterpolation:function(t,i,e){return t+(i-t)*e}},mounted:function(){navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(this.getUserMic).catch(function(t){return console.log(t)})},beforeDestroy:function(){this.micStream&&this.micStream.getAudioTracks()[0].stop()}}),r=n,s=(e("3c20"),e("2877")),c=Object(s["a"])(r,a,o,!1,null,"2a8ec38e",null);c.options.__file="VoiceChanger.vue";i["default"]=c.exports},"3c20":function(t,i,e){"use strict";var a=e("56d3"),o=e.n(a);o.a},"56d3":function(t,i,e){},"63d9":function(t,i,e){e("ec30")("Float32",4,function(t){return function(i,e,a){return t(this,i,e,a)}})}}]);
//# sourceMappingURL=chunk-227b82a9.f45e55ee.js.map
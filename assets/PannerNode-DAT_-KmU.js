import{d as B,b as U,e as V,r as l,c as A,f as t,w as x,g,t as w,h as _,n as h,j as E,m as I,k as R,l as T,o as M}from"./index-Dp99J6ZZ.js";import{a as S}from"./audioUnlock-CHVvazkl.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={id:"panner-node"},Y={id:"config"},j={class:"audio-note"},z={class:"item"},F={for:"frequency"},G={class:"audio-note"},O={class:"item"},J={for:"volume"},K=B({__name:"PannerNode",setup(L){const k=window.AudioContext||window.webkitAudioContext,s=new k,r=s.createOscillator(),p=s.createGain(),i=s.createPanner(),P=s.listener,u=l(!1),b=l("triangle"),d=l(440),C=l(0),c=l(1),a=l(""),n=E({listener:{x:0,y:0},source:{x:0,y:0}});function N(){u.value?q():D(),u.value=!u.value}function m(){v()}function y(){d.value=440,c.value=1,n.listener.x=window.innerWidth/2+20,n.listener.y=window.innerHeight/2-50,n.source.x=window.innerWidth/2-20,n.source.y=window.innerHeight/2+50,v()}function D(){i.connect(s.destination)}function q(){i.disconnect(s.destination)}function v(){r.type=b.value,r.frequency.value=d.value,r.detune.value=C.value,p.gain.value=c.value,i.setPosition(n.source.x,n.source.y,1),P.setPosition(n.listener.x,n.listener.y,0)}const H=T(()=>({mousedown:o=>{const e=o.target.id;(e==="source"||e==="listener")&&(a.value=e)},mousemove:o=>{if(!a.value)return;const e=a.value;n[e].x=o.clientX-25,n[e].y=o.clientY-25,v(),o.preventDefault()},mouseup:()=>{a.value=""},touchstart:o=>{const e=o.target.id;(e==="source"||e==="listener")&&(a.value=e)},touchmove:o=>{if(!a.value)return;const e=a.value;n[e].x=o.touches[0].pageX-25,n[e].y=o.touches[0].pageY-25,v(),o.preventDefault()},touchend:()=>{a.value=""}}));return U(()=>{S(s),y(),v(),i.rolloffFactor=.1,r.connect(p),p.connect(i),r.start()}),V(()=>{u.value&&(i.disconnect(s.destination),u.value=!1)}),(o,e)=>(M(),A("div",X,[e[6]||(e[6]=t("h1",{class:"text-3xl font-bold text-center my-8 dark:text-white"},"2D Panner Node",-1)),t("div",{class:"text-center my-4"},[t("button",{class:"btn",onClick:N}," Play / Pause "),t("button",{class:"btn",onClick:y}," Reset ")]),t("div",Y,[t("div",j,[e[3]||(e[3]=t("h3",null,[t("span",null,"音源")],-1)),t("div",z,[t("label",F,[e[2]||(e[2]=g("frequency : ",-1)),t("span",null,w(d.value),1)]),x(t("input",{type:"range",min:"0",max:"1960",step:"1",id:"frequencyRange","onUpdate:modelValue":e[0]||(e[0]=f=>d.value=f),onInput:m,class:"accent-primary"},null,544),[[_,d.value]])])]),t("div",G,[e[5]||(e[5]=t("h3",null,[t("span",null,"增益節點")],-1)),t("div",O,[t("label",J,[e[4]||(e[4]=g("volume : ",-1)),t("span",null,w(c.value),1)]),x(t("input",{type:"range",min:"0",max:"5",step:"0.1",id:"volumeRange","onUpdate:modelValue":e[1]||(e[1]=f=>c.value=f),onInput:m,class:"accent-primary"},null,544),[[_,c.value]])])])]),t("div",I({id:"drag-area","data-role":"drag-drop-container"},R(H.value)),[t("div",{id:"listener",style:h({left:n.listener.x+"px",top:n.listener.y+"px"})}," 聽者 ",4),t("div",{id:"source",style:h({left:n.source.x+"px",top:n.source.y+"px"})}," 音源 ",4)],16)]))}}),ee=W(K,[["__scopeId","data-v-f2aa8454"]]);export{ee as default};

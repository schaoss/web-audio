import{d as T,b as j,e as z,c as y,f as n,w as C,g as b,t as k,r as f,h as A,F as O,i as W,n as E,o as M}from"./index-Dp99J6ZZ.js";import{a as G}from"./audioUnlock-CHVvazkl.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const L={id:"voice-changer"},q={id:"config"},J={class:"audio-note"},K={class:"item"},Q={for:"pitchRatio"},X={class:"item"},Y={for:"overlapRatio"},Z={class:"result"},a=2048,$=T({__name:"VoiceChanger",setup(tt){const F=window.AudioContext||window.webkitAudioContext,r=new F,c=r.createGain();c.gain.value=1;const p=f(!1);let v=null;const g=f(new Float32Array(2048)),l=f(1),u=f(.5);function S(){p.value?V():D()}function D(){p.value=!0,c.connect(r.destination)}function V(){p.value=!1,c.disconnect(r.destination)}function B(i){v=i;const t=new Float32Array(a*2),o=R(a),I=r.createMediaStreamSource(i),m=r.createScriptProcessor(a,1,1);m.onaudioprocess=h=>{const d=h.inputBuffer.getChannelData(0),_=h.outputBuffer.getChannelData(0);for(let e=0;e<d.length;e++)d[e]*=o[e],t[e]=t[e+a],t[e+a]=0;const x=new Float32Array(a);for(let e=0,s=0;e<a;e++,s+=parseFloat(String(l.value))){const w=Math.floor(s)%a,N=d[w],P=d[(w+1)%a];x[e]+=U(N,P,s%l.value)*o[e]}for(let e=0;e<a;e+=Math.round(a*u.value))for(let s=0;s<=a;s++)t[e+s]+=x[s];for(let e=0;e<a;e++)_[e]=t[e]||0;g.value=_},I.connect(m),m.connect(c)}function R(i){const t=new Float32Array(i);for(let o=0;o<i;o++)t[o]=.5*(1-Math.cos(2*Math.PI*o/(i-1)));return t}function U(i,t,o){return i+(t-i)*o}return j(()=>{G(r),navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(B).catch(i=>console.error(i))}),z(()=>{v&&v.getAudioTracks()[0].stop()}),(i,t)=>(M(),y("div",L,[t[4]||(t[4]=n("h1",{class:"text-3xl font-bold text-center my-8 dark:text-white"},"VoiceChanger",-1)),n("div",{class:"text-center my-4"},[n("button",{class:"btn",onClick:S}," On / Off ")]),n("div",q,[n("div",J,[n("div",K,[n("label",Q,[t[2]||(t[2]=b("頻率倍率 : ",-1)),n("span",null,k(l.value),1)]),C(n("input",{type:"range",min:"0.5",max:"2",step:"0.01",id:"pitchRatio","onUpdate:modelValue":t[0]||(t[0]=o=>l.value=o),class:"accent-primary"},null,512),[[A,l.value]])]),n("div",X,[n("label",Y,[t[3]||(t[3]=b("重疊率 : ",-1)),n("span",null,k(u.value),1)]),C(n("input",{type:"range",min:"0.1",max:"1",step:"0.01",id:"overlapRatio","onUpdate:modelValue":t[1]||(t[1]=o=>u.value=o),class:"accent-primary"},null,512),[[A,u.value]])]),n("div",Z,[(M(),y(O,null,W(512,o=>n("div",{class:"timeData",key:o,style:E({height:g.value[o-1]*200+2+"px"})},null,4)),64))])])])]))}}),at=H($,[["__scopeId","data-v-3dd3ff77"]]);export{at as default};
